<!DOCTYPE html>
<html>
<head>
	<title>Test Page</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<script type="text/javascript" src="../src/cryptogame.js"></script>
</head>
<body>
	Test Page MASTER
	<button onclick="sendMesg1()">send data to Slave1</button>
	<button onclick="sendMesg2()">send data to Slave2</button>
	<br/>
	<iframe src="slave1.html" name="SLAVE1" id="SLAVE1"></iframe>
	<iframe src="slave2.html" name="SLAVE2" id="SLAVE2"></iframe>
	<div id="content"></div>
</body>

<script type="text/javascript">
	var me = CTG.component.name;
	function genInfo(name){
		return {info : "Hello [" + name + "] , I am [" + me + "] Now at " + new Date()};
	}

	function sendMesg1 (argument) {
		CTG.send("SLAVE1" , "changeSlave1" ,genInfo("SLAVE1") ,function(data){
			console.log("callback fire");
			writeHtml(data);
		});
	}

	function sendMesg2 (argument) {
		CTG.send("SLAVE2" , "changeSlave2" , genInfo("SLAVE2"));
	}

	CTG.addEventListener("changeMaster" , function(data){
		writeHtml(data.info);
	});

	function writeHtml(text){
		var content = document.getElementById("content");
		content.innerHTML += "<br/>" + text;
	}
	console.log(CTG);

</script>
</html>
